import{i as p,y as k,o as l,f as c,b as e,t as m,F as h,j as y,n as q,a as d,C,l as V,h as S,w as j,u as b,e as F,q as x,d as T}from"./app-D2Fj5F7q.js";import{_ as B}from"./AuthenticatedLayout-BlfXxPpd.js";import{P as D}from"./PrimaryButton-BZjr5Uyd.js";import{_ as O,a as P,b as I}from"./TextInput-BESpke2H.js";import{_ as N}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css            */const U={class:"is-flex is-flex-direction-column"},z={class:"is-size-5 has-text-weight-medium has-text-grey-dark m-0 [-0"},A={class:"stars"},E=["onClick"],L={class:"container mt-2"},M={__name:"Rating",props:{question:String},emits:["update-rating"],setup(o,{emit:r}){const a=p(0),s=p(""),v=p({comment:null}),g=r,_=()=>{const i={stars:a.value,comment:s.value};g("update-rating",i)};k([a,s],()=>{a.value<=3&&!s.value?v.value.comment="Comment is required with ratings below 3.":v.value.comment=null});const w=i=>{a.value=i,_()};return(i,t)=>(l(),c("div",U,[e("p",z,m(o.question),1),e("div",A,[(l(),c(h,null,y(5,n=>e("span",{key:n,class:q(["star",{filled:n<=a.value}]),onClick:u=>w(n)}," â˜… ",10,E)),64))]),e("div",L,[d(O,{for:"comment",value:"Comment",class:""}),d(P,{id:"comment",class:"mt-1",modelValue:s.value,"onUpdate:modelValue":t[0]||(t[0]=n=>s.value=n),autofocus:"",onChange:_},null,8,["modelValue"]),d(I,{class:"mt-2",message:v.value.comment},null,8,["message"])])]))}},G=N(M,[["__scopeId","data-v-293cc59e"]]),H={class:"section"},J={class:"breadcrumb","aria-label":"breadcrumbs"},K=["href"],Q={class:"title has-text-primary"},W={class:"subtitle has-text-primary"},X={class:"has-text-grey title is-6"},Y={class:"content"},Z={class:"mt-4 is-flex is-justify-content-end"},oe=Object.assign({layout:B},{__name:"Show",props:{review:{type:Object},questions:{type:Array,default:[]},roles:{type:Array},reviewType:{type:String}},setup(o){const r=o,a=p([]),s=C({ratings:a.value,review_id:r.review.id});V(()=>{a.value=Object.keys(r.questions).map(i=>r.questions[i].map(t=>({review_id:r.review.id,question_id:t.id,reviewer_id:x().props.auth.user.id,rating:0,comment:""}))).flat()});const g=(i,t)=>{const n={review_id:r.review.id,question_id:i,reviewer_id:x().props.auth.user.id,comment:t.comment,rating:t.stars},u=a.value.findIndex(f=>f.question_id==n.question_id);u!==-1&&(a.value[u]=n)},_=S(()=>a.value.every(i=>!(i.rating<=3&&!i.comment.trim()))),w=()=>{s.ratings=a.value,s.review_id=r.review.id,s.post(route("reviews.complete"),s.data,{onFinish:()=>s.reset(),forceFormData:!0})};return(i,t)=>(l(),c("section",H,[e("nav",J,[e("ul",null,[e("li",null,[e("a",{href:i.route(`reviews.${o.reviewType.toLowerCase()}`)},m(o.reviewType)+" Reviews",9,K)]),t[0]||(t[0]=e("li",{class:"is-active"},[e("a",{href:"#","aria-current":"page"},"Review")],-1))])]),e("form",{onSubmit:F(w,["prevent"]),method:"POST"},[e("h1",Q,m(o.review.review_cycle.title),1),e("h2",W,"Review for "+m(o.review.reviewee.name)+" "+m(o.review.reviewee.surname),1),e("div",null,[(l(!0),c(h,null,y(o.questions,(n,u)=>(l(),c("div",{key:u,class:"mb-5"},[e("h4",X,m(u),1),e("div",Y,[(l(!0),c(h,null,y(n,(f,R)=>(l(),c("div",{key:R,class:"mb-6"},[d(G,{question:f.question,onUpdateRating:$=>g(f.id,$)},null,8,["question","onUpdateRating"])]))),128))]),t[1]||(t[1]=e("hr",{class:"has-background-grey-light my-6"},null,-1))]))),128))]),e("div",Z,[d(D,{class:q({"opacity-25":b(s).processing}),disabled:b(s).processing||!_.value},{default:j(()=>t[2]||(t[2]=[T(" Finish Review ")])),_:1},8,["class","disabled"])])],32)]))}});export{oe as default};
